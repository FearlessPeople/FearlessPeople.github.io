<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Python-Flask基础 | 浅墨散人</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="浅墨散人,大数据,数据仓库,python,基础,数仓,bigdata,datawarehouse,maven,vuepress,java,hadoop,个人,博客">
    
    <link rel="preload" href="/assets/css/0.styles.3469acc3.css" as="style"><link rel="preload" href="/assets/js/app.6c912f34.js" as="script"><link rel="preload" href="/assets/js/2.a5fab8cd.js" as="script"><link rel="preload" href="/assets/js/131.4ba5d4e1.js" as="script"><link rel="prefetch" href="/assets/js/10.7d745c33.js"><link rel="prefetch" href="/assets/js/100.5e648912.js"><link rel="prefetch" href="/assets/js/101.f2f1f4d4.js"><link rel="prefetch" href="/assets/js/102.5fa42421.js"><link rel="prefetch" href="/assets/js/103.ac4770fc.js"><link rel="prefetch" href="/assets/js/104.5f245895.js"><link rel="prefetch" href="/assets/js/105.7880dd4c.js"><link rel="prefetch" href="/assets/js/106.f7aa17a8.js"><link rel="prefetch" href="/assets/js/107.22d17955.js"><link rel="prefetch" href="/assets/js/108.ef4115a9.js"><link rel="prefetch" href="/assets/js/109.17bbdb62.js"><link rel="prefetch" href="/assets/js/11.725b3448.js"><link rel="prefetch" href="/assets/js/110.6a09ce4d.js"><link rel="prefetch" href="/assets/js/111.914f7a74.js"><link rel="prefetch" href="/assets/js/112.9310899b.js"><link rel="prefetch" href="/assets/js/113.190601ed.js"><link rel="prefetch" href="/assets/js/114.72ad8da5.js"><link rel="prefetch" href="/assets/js/115.78302042.js"><link rel="prefetch" href="/assets/js/116.d6e51d1a.js"><link rel="prefetch" href="/assets/js/117.1d48e80c.js"><link rel="prefetch" href="/assets/js/118.c8470202.js"><link rel="prefetch" href="/assets/js/119.5f6b5670.js"><link rel="prefetch" href="/assets/js/12.cd4b727e.js"><link rel="prefetch" href="/assets/js/120.6824c181.js"><link rel="prefetch" href="/assets/js/121.b270f443.js"><link rel="prefetch" href="/assets/js/122.06f22009.js"><link rel="prefetch" href="/assets/js/123.5a0ff76b.js"><link rel="prefetch" href="/assets/js/124.3518756a.js"><link rel="prefetch" href="/assets/js/125.2c865a5d.js"><link rel="prefetch" href="/assets/js/126.59da54b1.js"><link rel="prefetch" href="/assets/js/127.d9332101.js"><link rel="prefetch" href="/assets/js/128.b1932383.js"><link rel="prefetch" href="/assets/js/129.d7360ecd.js"><link rel="prefetch" href="/assets/js/13.86b7cfdd.js"><link rel="prefetch" href="/assets/js/130.f5d6332a.js"><link rel="prefetch" href="/assets/js/132.c4c9b32d.js"><link rel="prefetch" href="/assets/js/133.38378151.js"><link rel="prefetch" href="/assets/js/134.60d59cea.js"><link rel="prefetch" href="/assets/js/135.a5ca9287.js"><link rel="prefetch" href="/assets/js/136.0cdd8ead.js"><link rel="prefetch" href="/assets/js/137.65e596bf.js"><link rel="prefetch" href="/assets/js/138.d535c64b.js"><link rel="prefetch" href="/assets/js/139.43609ee4.js"><link rel="prefetch" href="/assets/js/14.f8354e8c.js"><link rel="prefetch" href="/assets/js/140.f5f8ee60.js"><link rel="prefetch" href="/assets/js/141.70b71510.js"><link rel="prefetch" href="/assets/js/142.b5df5dac.js"><link rel="prefetch" href="/assets/js/143.6d72722d.js"><link rel="prefetch" href="/assets/js/144.14e9b373.js"><link rel="prefetch" href="/assets/js/145.0edc2285.js"><link rel="prefetch" href="/assets/js/146.bbe6bbe5.js"><link rel="prefetch" href="/assets/js/147.8204f8d7.js"><link rel="prefetch" href="/assets/js/148.acc6bdb0.js"><link rel="prefetch" href="/assets/js/149.52208a74.js"><link rel="prefetch" href="/assets/js/15.606945b6.js"><link rel="prefetch" href="/assets/js/150.b7c5e3eb.js"><link rel="prefetch" href="/assets/js/151.a5d66a5b.js"><link rel="prefetch" href="/assets/js/152.9d91fa40.js"><link rel="prefetch" href="/assets/js/153.4fcf5863.js"><link rel="prefetch" href="/assets/js/154.7f31564a.js"><link rel="prefetch" href="/assets/js/155.937ccab9.js"><link rel="prefetch" href="/assets/js/156.0daaf37c.js"><link rel="prefetch" href="/assets/js/157.c24dbaf1.js"><link rel="prefetch" href="/assets/js/158.8464ac0a.js"><link rel="prefetch" href="/assets/js/159.765b04c6.js"><link rel="prefetch" href="/assets/js/16.5510745b.js"><link rel="prefetch" href="/assets/js/160.c0dd73e3.js"><link rel="prefetch" href="/assets/js/161.551e882f.js"><link rel="prefetch" href="/assets/js/162.dc1a584a.js"><link rel="prefetch" href="/assets/js/163.2e48aa95.js"><link rel="prefetch" href="/assets/js/164.e22ca880.js"><link rel="prefetch" href="/assets/js/165.51db2539.js"><link rel="prefetch" href="/assets/js/166.cd1fbc15.js"><link rel="prefetch" href="/assets/js/167.62097d45.js"><link rel="prefetch" href="/assets/js/168.7056a8a5.js"><link rel="prefetch" href="/assets/js/169.51c8d361.js"><link rel="prefetch" href="/assets/js/17.93c98dd8.js"><link rel="prefetch" href="/assets/js/170.f388b729.js"><link rel="prefetch" href="/assets/js/171.e9dc7699.js"><link rel="prefetch" href="/assets/js/172.1e07c541.js"><link rel="prefetch" href="/assets/js/173.8ee69bad.js"><link rel="prefetch" href="/assets/js/174.e9dab3bc.js"><link rel="prefetch" href="/assets/js/175.bdcf8a68.js"><link rel="prefetch" href="/assets/js/176.95df5c34.js"><link rel="prefetch" href="/assets/js/177.e42bd268.js"><link rel="prefetch" href="/assets/js/178.0f7ea3da.js"><link rel="prefetch" href="/assets/js/179.aefd24c7.js"><link rel="prefetch" href="/assets/js/18.5ffec66b.js"><link rel="prefetch" href="/assets/js/180.7aadf357.js"><link rel="prefetch" href="/assets/js/181.c0b65153.js"><link rel="prefetch" href="/assets/js/19.7e3eadd8.js"><link rel="prefetch" href="/assets/js/20.28ea6dc9.js"><link rel="prefetch" href="/assets/js/21.cf152cba.js"><link rel="prefetch" href="/assets/js/22.6e08c29c.js"><link rel="prefetch" href="/assets/js/23.c2a30b3e.js"><link rel="prefetch" href="/assets/js/24.8885a897.js"><link rel="prefetch" href="/assets/js/25.1924e50e.js"><link rel="prefetch" href="/assets/js/26.a984dc17.js"><link rel="prefetch" href="/assets/js/27.785f9d35.js"><link rel="prefetch" href="/assets/js/28.53cd70c7.js"><link rel="prefetch" href="/assets/js/29.2cf9994f.js"><link rel="prefetch" href="/assets/js/3.faab207a.js"><link rel="prefetch" href="/assets/js/30.75de16cd.js"><link rel="prefetch" href="/assets/js/31.aa384d5e.js"><link rel="prefetch" href="/assets/js/32.874d2683.js"><link rel="prefetch" href="/assets/js/33.307e079b.js"><link rel="prefetch" href="/assets/js/34.a9ece373.js"><link rel="prefetch" href="/assets/js/35.59e8f4ef.js"><link rel="prefetch" href="/assets/js/36.fb4f9cd3.js"><link rel="prefetch" href="/assets/js/37.0600f3df.js"><link rel="prefetch" href="/assets/js/38.a15b04a0.js"><link rel="prefetch" href="/assets/js/39.3bad5379.js"><link rel="prefetch" href="/assets/js/4.1fdcdd40.js"><link rel="prefetch" href="/assets/js/40.76f01b1b.js"><link rel="prefetch" href="/assets/js/41.93046fd9.js"><link rel="prefetch" href="/assets/js/42.e4e7490e.js"><link rel="prefetch" href="/assets/js/43.37ebc8af.js"><link rel="prefetch" href="/assets/js/44.fd88b492.js"><link rel="prefetch" href="/assets/js/45.1622e2ab.js"><link rel="prefetch" href="/assets/js/46.eecdff60.js"><link rel="prefetch" href="/assets/js/47.cd172e47.js"><link rel="prefetch" href="/assets/js/48.19db3b6c.js"><link rel="prefetch" href="/assets/js/49.482a801f.js"><link rel="prefetch" href="/assets/js/5.2c554a17.js"><link rel="prefetch" href="/assets/js/50.17b21c39.js"><link rel="prefetch" href="/assets/js/51.7730402f.js"><link rel="prefetch" href="/assets/js/52.490bf98c.js"><link rel="prefetch" href="/assets/js/53.197056a7.js"><link rel="prefetch" href="/assets/js/54.ea4308a3.js"><link rel="prefetch" href="/assets/js/55.b4d03e91.js"><link rel="prefetch" href="/assets/js/56.fea10cb1.js"><link rel="prefetch" href="/assets/js/57.b55e1704.js"><link rel="prefetch" href="/assets/js/58.1d522d79.js"><link rel="prefetch" href="/assets/js/59.33e2fb85.js"><link rel="prefetch" href="/assets/js/6.77307bac.js"><link rel="prefetch" href="/assets/js/60.25516510.js"><link rel="prefetch" href="/assets/js/61.aa2244d4.js"><link rel="prefetch" href="/assets/js/62.88ce1d7f.js"><link rel="prefetch" href="/assets/js/63.17ecf6eb.js"><link rel="prefetch" href="/assets/js/64.e44283e6.js"><link rel="prefetch" href="/assets/js/65.65b614ae.js"><link rel="prefetch" href="/assets/js/66.cdfc0768.js"><link rel="prefetch" href="/assets/js/67.ea05e037.js"><link rel="prefetch" href="/assets/js/68.c687f735.js"><link rel="prefetch" href="/assets/js/69.22b88afa.js"><link rel="prefetch" href="/assets/js/7.f6e67e09.js"><link rel="prefetch" href="/assets/js/70.bbb2531e.js"><link rel="prefetch" href="/assets/js/71.9ed6227c.js"><link rel="prefetch" href="/assets/js/72.9ed06af0.js"><link rel="prefetch" href="/assets/js/73.735fcb3b.js"><link rel="prefetch" href="/assets/js/74.83eb0dd1.js"><link rel="prefetch" href="/assets/js/75.fe12e939.js"><link rel="prefetch" href="/assets/js/76.ebc91488.js"><link rel="prefetch" href="/assets/js/77.1647902e.js"><link rel="prefetch" href="/assets/js/78.41da6dd2.js"><link rel="prefetch" href="/assets/js/79.013df807.js"><link rel="prefetch" href="/assets/js/8.277a120d.js"><link rel="prefetch" href="/assets/js/80.5f4dff77.js"><link rel="prefetch" href="/assets/js/81.c997dd60.js"><link rel="prefetch" href="/assets/js/82.1b373725.js"><link rel="prefetch" href="/assets/js/83.a5c7b4e3.js"><link rel="prefetch" href="/assets/js/84.37b6e57d.js"><link rel="prefetch" href="/assets/js/85.cb439990.js"><link rel="prefetch" href="/assets/js/86.e2336b0f.js"><link rel="prefetch" href="/assets/js/87.fde2d49a.js"><link rel="prefetch" href="/assets/js/88.9886e179.js"><link rel="prefetch" href="/assets/js/89.2787fa70.js"><link rel="prefetch" href="/assets/js/9.e93c1c45.js"><link rel="prefetch" href="/assets/js/90.cfdd06ad.js"><link rel="prefetch" href="/assets/js/91.b2723ef5.js"><link rel="prefetch" href="/assets/js/92.70f05d11.js"><link rel="prefetch" href="/assets/js/93.3577f1fc.js"><link rel="prefetch" href="/assets/js/94.f6f5f54c.js"><link rel="prefetch" href="/assets/js/95.59a87213.js"><link rel="prefetch" href="/assets/js/96.971f0019.js"><link rel="prefetch" href="/assets/js/97.9ff15b14.js"><link rel="prefetch" href="/assets/js/98.f075fd0c.js"><link rel="prefetch" href="/assets/js/99.57e02acb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3469acc3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/hero.png" alt="浅墨散人" class="logo"> <span class="site-name can-hide">浅墨散人</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/Basic/" class="nav-link">基础</a></li><li class="dropdown-item"><!----> <a href="/Java/DesignPattern/" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/Java/JVM/" class="nav-link">JVM</a></li><li class="dropdown-item"><!----> <a href="/Java/Maven/" class="nav-link">Maven</a></li><li class="dropdown-item"><!----> <a href="/Java/SpringBoot/" class="nav-link">SpringBoot</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><!----> <span class="title" style="display:;">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Python/Basic/" class="nav-link">基础</a></li><li class="dropdown-item"><!----> <a href="/Python/Flask/" class="nav-link">Flask</a></li><li class="dropdown-item"><!----> <a href="/Python/Django/" class="nav-link">Diango</a></li><li class="dropdown-item"><!----> <a href="/Python/Pandas/" class="nav-link">Pandas</a></li><li class="dropdown-item"><!----> <a href="/Python/SqlAlchemy/" class="nav-link">SqlAlchemy</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><!----> <span class="title" style="display:;">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BigData/Sqoop/" class="nav-link">Sqoop</a></li><li class="dropdown-item"><!----> <a href="/BigData/Flume/" class="nav-link">Flume</a></li><li class="dropdown-item"><!----> <a href="/BigData/Flink/" class="nav-link">Flink</a></li><li class="dropdown-item"><!----> <a href="/BigData/Hadoop/" class="nav-link">Hadoop</a></li><li class="dropdown-item"><!----> <a href="/BigData/Hbase/" class="nav-link">Hbase</a></li><li class="dropdown-item"><!----> <a href="/BigData/Hive/" class="nav-link">Hive</a></li><li class="dropdown-item"><!----> <a href="/BigData/Kafka/" class="nav-link">Kafka</a></li><li class="dropdown-item"><!----> <a href="/BigData/Kylin/" class="nav-link">Kylin</a></li><li class="dropdown-item"><!----> <a href="/BigData/Zookeeper/" class="nav-link">Zookeeper</a></li><li class="dropdown-item"><!----> <a href="/BigData/Tez/" class="nav-link">Tez</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/DataBase/MySQL/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Doris/" class="nav-link">Doris</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><!----> <span class="title" style="display:;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Tools/Chrome/" class="nav-link">Chrome</a></li><li class="dropdown-item"><!----> <a href="/Tools/Eclipse/" class="nav-link">Eclipse</a></li><li class="dropdown-item"><!----> <a href="/Tools/IDEA/" class="nav-link">IDEA</a></li><li class="dropdown-item"><!----> <a href="/Tools/iTerm2/" class="nav-link">iTerm2</a></li><li class="dropdown-item"><!----> <a href="/Tools/Markdown/" class="nav-link">Markdown</a></li><li class="dropdown-item"><!----> <a href="/Tools/SublimeText/" class="nav-link">SublimeText</a></li><li class="dropdown-item"><!----> <a href="/Tools/VirtualBox/" class="nav-link">VirtualBox</a></li><li class="dropdown-item"><!----> <a href="/Tools/WebStrom/" class="nav-link">WebStrom</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统" class="dropdown-title"><!----> <span class="title" style="display:;">系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/System/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/System/Mac/" class="nav-link">Mac</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><!----> <span class="title" style="display:;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Other/Hexo/" class="nav-link">Hexo</a></li><li class="dropdown-item"><!----> <a href="/Other/Git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/Other/Vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/Other/VuePress/" class="nav-link">VuePress</a></li><li class="dropdown-item"><!----> <a href="/Other/BlockChain/" class="nav-link">区块链</a></li><li class="dropdown-item"><!----> <a href="/Other/Finance/" class="nav-link">金融</a></li></ul></div></div><div class="nav-item"><a href="/DatawareHouse/" class="nav-link">数据仓库</a></div><div class="nav-item"><a href="/DataGovernance/" class="nav-link">数据治理</a></div><div class="nav-item"><a href="/ReadingNotes/" class="nav-link">读书笔记</a></div><div class="nav-item"><a href="/About/" class="nav-link">关于我</a></div> <a href="https://github.com/FearlessPeople" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/Basic/" class="nav-link">基础</a></li><li class="dropdown-item"><!----> <a href="/Java/DesignPattern/" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/Java/JVM/" class="nav-link">JVM</a></li><li class="dropdown-item"><!----> <a href="/Java/Maven/" class="nav-link">Maven</a></li><li class="dropdown-item"><!----> <a href="/Java/SpringBoot/" class="nav-link">SpringBoot</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Python" class="dropdown-title"><!----> <span class="title" style="display:;">Python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Python/Basic/" class="nav-link">基础</a></li><li class="dropdown-item"><!----> <a href="/Python/Flask/" class="nav-link">Flask</a></li><li class="dropdown-item"><!----> <a href="/Python/Django/" class="nav-link">Diango</a></li><li class="dropdown-item"><!----> <a href="/Python/Pandas/" class="nav-link">Pandas</a></li><li class="dropdown-item"><!----> <a href="/Python/SqlAlchemy/" class="nav-link">SqlAlchemy</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><!----> <span class="title" style="display:;">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BigData/Sqoop/" class="nav-link">Sqoop</a></li><li class="dropdown-item"><!----> <a href="/BigData/Flume/" class="nav-link">Flume</a></li><li class="dropdown-item"><!----> <a href="/BigData/Flink/" class="nav-link">Flink</a></li><li class="dropdown-item"><!----> <a href="/BigData/Hadoop/" class="nav-link">Hadoop</a></li><li class="dropdown-item"><!----> <a href="/BigData/Hbase/" class="nav-link">Hbase</a></li><li class="dropdown-item"><!----> <a href="/BigData/Hive/" class="nav-link">Hive</a></li><li class="dropdown-item"><!----> <a href="/BigData/Kafka/" class="nav-link">Kafka</a></li><li class="dropdown-item"><!----> <a href="/BigData/Kylin/" class="nav-link">Kylin</a></li><li class="dropdown-item"><!----> <a href="/BigData/Zookeeper/" class="nav-link">Zookeeper</a></li><li class="dropdown-item"><!----> <a href="/BigData/Tez/" class="nav-link">Tez</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/DataBase/MySQL/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Doris/" class="nav-link">Doris</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><!----> <span class="title" style="display:;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Tools/Chrome/" class="nav-link">Chrome</a></li><li class="dropdown-item"><!----> <a href="/Tools/Eclipse/" class="nav-link">Eclipse</a></li><li class="dropdown-item"><!----> <a href="/Tools/IDEA/" class="nav-link">IDEA</a></li><li class="dropdown-item"><!----> <a href="/Tools/iTerm2/" class="nav-link">iTerm2</a></li><li class="dropdown-item"><!----> <a href="/Tools/Markdown/" class="nav-link">Markdown</a></li><li class="dropdown-item"><!----> <a href="/Tools/SublimeText/" class="nav-link">SublimeText</a></li><li class="dropdown-item"><!----> <a href="/Tools/VirtualBox/" class="nav-link">VirtualBox</a></li><li class="dropdown-item"><!----> <a href="/Tools/WebStrom/" class="nav-link">WebStrom</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="系统" class="dropdown-title"><!----> <span class="title" style="display:;">系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/System/Linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/System/Mac/" class="nav-link">Mac</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><!----> <span class="title" style="display:;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Other/Hexo/" class="nav-link">Hexo</a></li><li class="dropdown-item"><!----> <a href="/Other/Git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/Other/Vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/Other/VuePress/" class="nav-link">VuePress</a></li><li class="dropdown-item"><!----> <a href="/Other/BlockChain/" class="nav-link">区块链</a></li><li class="dropdown-item"><!----> <a href="/Other/Finance/" class="nav-link">金融</a></li></ul></div></div><div class="nav-item"><a href="/DatawareHouse/" class="nav-link">数据仓库</a></div><div class="nav-item"><a href="/DataGovernance/" class="nav-link">数据治理</a></div><div class="nav-item"><a href="/ReadingNotes/" class="nav-link">读书笔记</a></div><div class="nav-item"><a href="/About/" class="nav-link">关于我</a></div> <a href="https://github.com/FearlessPeople" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Flask</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/eea4c8/" class="sidebar-link">Flask</a></li><li><a href="/pages/316c1f/" aria-current="page" class="active sidebar-link">Python-Flask基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#flask介绍" class="sidebar-link">Flask介绍</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#flask安装" class="sidebar-link">Flask安装</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#hello-word" class="sidebar-link">Hello Word</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#debug模式" class="sidebar-link">Debug模式</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#url传参" class="sidebar-link">URL传参</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#url反转" class="sidebar-link">URL反转</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#页面跳转" class="sidebar-link">页面跳转</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#重定向" class="sidebar-link">重定向</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#模板和参数" class="sidebar-link">模板和参数</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#jinja2模板引擎" class="sidebar-link">Jinja2模板引擎</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#打印变量" class="sidebar-link">打印变量</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#if语句" class="sidebar-link">if语句</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#for语句" class="sidebar-link">for语句</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#过滤器" class="sidebar-link">过滤器</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#jinja2的继承" class="sidebar-link">Jinja2的继承</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#url链接" class="sidebar-link">URL链接</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#加载静态文件" class="sidebar-link">加载静态文件</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#flask-sqlalchemy" class="sidebar-link">Flask-SQLAlchemy</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#连接到sqlite数据库" class="sidebar-link">连接到SQLite数据库</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#连接到mysql数据库" class="sidebar-link">连接到MySQL数据库</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#flask-sqlalchemy模型映射" class="sidebar-link">Flask-SQLAlchemy模型映射</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#flask-sqlalchemy增删改查" class="sidebar-link">Flask-SQLAlchemy增删改查</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#flask-script" class="sidebar-link">Flask-Script</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#flask-migrate" class="sidebar-link">Flask-Migrate</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#安装-2" class="sidebar-link">安装</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#初始化" class="sidebar-link">初始化</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#迁移" class="sidebar-link">迁移</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#应用迁移" class="sidebar-link">应用迁移</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#flask的models循环引用的问题" class="sidebar-link">Flask的models循环引用的问题</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#flask-cookie" class="sidebar-link">Flask-Cookie</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#flask-session" class="sidebar-link">Flask-Session</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#flask中操作session" class="sidebar-link">flask中操作session</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#get和post请求" class="sidebar-link">Get和Post请求</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#get" class="sidebar-link">Get</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#post" class="sidebar-link">Post</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#g-global-对象" class="sidebar-link">g(global)对象</a></li><li class="sidebar-sub-header level2"><a href="/pages/316c1f/#钩子函数" class="sidebar-link">钩子函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#before-first-request" class="sidebar-link">beforefirstrequest</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#before-request" class="sidebar-link">before_request</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#context-processt" class="sidebar-link">context_processt</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#teardown-appcontext" class="sidebar-link">teardown_appcontext</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#template-filter" class="sidebar-link">template_filter</a></li><li class="sidebar-sub-header level3"><a href="/pages/316c1f/#errorhander" class="sidebar-link">errorhander</a></li></ul></li></ul></li><li><a href="/pages/e6e420/" class="sidebar-link">【转】Python的命令行神器 Click</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=Python" title="分类" data-v-06225672>Python</a></li><li data-v-06225672><a href="/categories/?category=Flask" title="分类" data-v-06225672>Flask</a></li></ul> <div class="info" data-v-06225672><!----> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2018-12-02</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Python-Flask基础<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="flask介绍"><a href="#flask介绍" class="header-anchor">#</a> Flask介绍</h2> <p><a href="http://flask.pocoo.org/" target="_blank" rel="noopener noreferrer">Flask官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://docs.jinkan.org/docs/flask/" target="_blank" rel="noopener noreferrer">Flask中文链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Flask是一个非常流行的python的web框架，出生于2010年，本来这个项目只是作者在愚人节的一个玩笑，后来由于非常受欢迎，进而成为一个正式的项目。</p> <p>Flask如此流行的原因：</p> <ul><li><p>微框架、简洁、只做它需要做的、扩展性强</p></li> <li><p>Flask和相关的依赖（Jinja2，werkzeug）设计的非常优秀，用起来很爽</p></li> <li><p>开发效率高，比如使用SQLAlchemy的ORM操作数据库可以节省开发者大量书写SQL的时间</p></li> <li><p>社会活跃度非常高</p></li></ul> <h2 id="flask安装"><a href="#flask安装" class="header-anchor">#</a> Flask安装</h2> <p>安装很简单，直接使用pip安装即可</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pip install flask
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="hello-word"><a href="#hello-word" class="header-anchor">#</a> Hello Word</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>控制台打印：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>* Serving Flask app &quot;helloword&quot; (lazy loading)
 * Environment: production
   WARNING: Do not use the development server in a production environment.
   Use a production WSGI server instead.
 * Debug mode: off
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>打开浏览器访问 http://127.0.0.1:5000/</p> <p><img src="/img/Python/Flask/006tNbRwly1fxssn7w2zqj312o08i3z7.jpg" alt=""></p> <p>可以看到，可以访问后台，但是没找到路由。稍微改下程序，增加一个路由</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;hello,word&quot;</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>打开浏览器访问 <a href="http://127.0.0.1:5000/index" target="_blank" rel="noopener noreferrer">http://127.0.0.1:5000/index<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/img/Python/Flask/006tNbRwly1fxssplamdnj30jm04qmx7.jpg" alt=""></p> <p>访问成功</p> <h2 id="debug模式"><a href="#debug模式" class="header-anchor">#</a> Debug模式</h2> <p>默认情况下，我们使用<code>app.run()</code>启动的时候，当修改Python源码的时候，是不会热加载的。所以，我们要使用Debug的模式，并且出错的时候也不会提示错误位置。</p> <p><strong>方式1：app.run(debug=True)</strong></p> <p>可以直接使用<code>app.run(debug=True)</code>开启debug模式</p> <p><strong>方式2：使用config.py文件</strong></p> <p>还可以使用config.py文件，以配置的方式开启debug模式</p> <p><strong>config.py文件内容</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>DEBUG <span class="token operator">=</span> <span class="token boolean">True</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>Hellowrod.py文件内容</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">import</span> config

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
<span class="token comment"># 使用配置文件的方式开启debug模式</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>from_object<span class="token punctuation">(</span>config<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;hello,word&quot;</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>控制台打印如下：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code> * Serving Flask app &quot;helloword&quot; (lazy loading)
 * Environment: production
   WARNING: Do not use the development server in a production environment.
   Use a production WSGI server instead.
 * Debug mode: on
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: 944-718-490
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="url传参"><a href="#url传参" class="header-anchor">#</a> URL传参</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index/&lt;id&gt;'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 这里的id需要和上面的&lt;id&gt;名称一样</span>
    <span class="token keyword">return</span> <span class="token string">&quot;你请求的参数是：{id}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>当请求该URL的时候</p> <p><img src="/img/Python/Flask/006tNbRwly1fy0um6wv7cj30ki04i0t7.jpg" alt="image-20181209221113001"></p> <h2 id="url反转"><a href="#url反转" class="header-anchor">#</a> URL反转</h2> <p>所谓URL反转就是通过视图（函数）名称来得到URL地址，通过Flask的url_for函数来完成。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 1.导入url_for函数</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span>url_for
<span class="token keyword">import</span> config

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>from_object<span class="token punctuation">(</span>config<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index/&lt;id&gt;'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 这里的id需要和上面的&lt;id&gt;名称一样</span>
    <span class="token comment"># 2. 在url_for函数中传入视图名称(函数名称)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'user_list'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 得到视图对应的url地址,这里是/userlist/</span>
    <span class="token keyword">return</span> <span class="token string">&quot;你请求的参数是：{id}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/userlist/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">user_list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;this is user list page&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>请求http://127.0.0.1:5000/index/12345   后控制台得到如下结果</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token operator">/</span>userlist<span class="token operator">/</span>
<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">09</span><span class="token operator">/</span>Dec<span class="token operator">/</span><span class="token number">2018</span> <span class="token number">22</span><span class="token punctuation">:</span><span class="token number">35</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token string">&quot;GET /index/12345 HTTP/1.1&quot;</span> <span class="token number">200</span> <span class="token operator">-</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="页面跳转"><a href="#页面跳转" class="header-anchor">#</a> 页面跳转</h2> <p>页面跳转很简单，只需要在 @app.route()注解的函数中return相应的视图名称即可。</p> <h2 id="重定向"><a href="#重定向" class="header-anchor">#</a> 重定向</h2> <p>重定向需要使用Flask的redirect函数来实现，使用<code>from flask import Flask,url_for,redirect</code>来导入该函数</p> <p>示例：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span>url_for<span class="token punctuation">,</span>redirect
<span class="token keyword">import</span> config

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>from_object<span class="token punctuation">(</span>config<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index/&lt;id&gt;'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 这里的id需要和上面的&lt;id&gt;名称一样</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'user_list'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># return &quot;你请求的参数是：{id}&quot;.format(id=id)</span>

    <span class="token comment"># 1、直接使用return redirect('url地址')的方式重定向</span>
    <span class="token comment"># return redirect(&quot;/userlist&quot;) # 跳转到user_list页面</span>

    <span class="token comment"># 2、使用url_for的方式重定向</span>
    ulist <span class="token operator">=</span> url_for<span class="token punctuation">(</span><span class="token string">&quot;user_list&quot;</span><span class="token punctuation">)</span> <span class="token comment"># 注意这里写的函数名称，并不是route里的请求地址</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>ulist<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/userlist/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">user_list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;this is user list page&quot;</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>当访问<a href="http://127.0.0.1:5000/index/12345" target="_blank" rel="noopener noreferrer">http://127.0.0.1:5000/index/12345<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>后，会跳转到userlist页面</p> <h2 id="模板和参数"><a href="#模板和参数" class="header-anchor">#</a> 模板和参数</h2> <p>Flask中使用render_template函数来渲染模板</p> <p>render_template('html文件名称', 传递给前台的值)，例如：<code>return render_template('index.html',**content)</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 导入render_template</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span>render_template

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/&lt;username&gt;'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">username</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 给前台传递参数的方式</span>
    <span class="token comment"># 方式1： 直接在render_template中填写username参数</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span>username<span class="token operator">=</span>username<span class="token punctuation">)</span>

    <span class="token comment"># 方式2： 可以使用一个字典对象</span>
    <span class="token comment"># content = {</span>
    <span class="token comment">#     'username': u'张三',</span>
    <span class="token comment">#     'gender': u'男',</span>
    <span class="token comment">#     'age': 18</span>
    <span class="token comment"># }</span>

    <span class="token comment"># return render_template('index.html',**content)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>在项目根目录下的templates中新建一个index.html文件即可</p> <p><img src="/img/Python/Flask/006tNbRwly1fy0wwpsr9kj31i40liq8p.jpg" alt="image-20181209232451488"></p> <p>templates/index.html文件内容：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

this is index 文件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
姓名：{{ username }} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">&gt;</span></span>
性别：{{ gender }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">&gt;</span></span>
年龄：{{ age }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>访问http://127.0.0.1:5000/fangzheng 时，会得到如下页面。</p> <p><img src="/img/Python/Flask/006tNbRwly1fy0wyjrgehj30ju08imxt.jpg" alt="image-20181209233217304"></p> <p><strong>访问字典数据</strong>
如果后台传递的值是字典类型：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/&lt;username&gt;'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">username</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 给前台传递参数的方式</span>
    <span class="token comment"># 方式1： 直接在render_template中填写username参数</span>
    <span class="token comment"># return render_template('index.html',username=username)</span>

    <span class="token comment"># 方式2： 可以使用一个字典对象</span>
    content <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">u'张三'</span><span class="token punctuation">,</span>
        <span class="token string">'gender'</span><span class="token punctuation">:</span> <span class="token string">u'男'</span><span class="token punctuation">,</span>
        <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
        <span class="token string">'websites'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">'baidu'</span><span class="token punctuation">:</span> <span class="token string">'www.baidu.com'</span><span class="token punctuation">,</span>
            <span class="token string">'google'</span><span class="token punctuation">:</span> <span class="token string">'www.google.com'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span><span class="token operator">**</span>content<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>index.html访问字典中内容</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
{{ websites.baidu }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
{{ websites.google }}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>页面显示内容：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>this is index 文件
姓名：张三 
性别：男
年龄：18
www.baidu.com
www.google.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="jinja2模板引擎"><a href="#jinja2模板引擎" class="header-anchor">#</a> Jinja2模板引擎</h2> <p><a href="http://docs.jinkan.org/docs/jinja2/" target="_blank" rel="noopener noreferrer">Jinja2中文文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="打印变量"><a href="#打印变量" class="header-anchor">#</a> 打印变量</h3> <p>在jinja2中打印变量很简单，直接使用两个大括号即可</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ user.username }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="if语句"><a href="#if语句" class="header-anchor">#</a> if语句</h3> <p>jinja2的if语法也很简单，需要大括号和百分号包裹起来</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">if</span> <span class="token operator">**</span><span class="token operator">*</span> <span class="token operator">%</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">else</span> <span class="token operator">%</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>后台Python代码如下：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/&lt;is_login&gt;/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>is_login<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> is_login <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>
        user <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'username'</span><span class="token punctuation">:</span><span class="token string">'张三'</span><span class="token punctuation">,</span>
            <span class="token string">'age'</span><span class="token punctuation">:</span><span class="token number">18</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">,</span>user<span class="token operator">=</span>user<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>前台html代码如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

    {% if user %}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ user.username }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>退出<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    {% else %}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>注册<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    {% endif %}

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>浏览器中请求，1表示登录，其他表示未登录</p> <p><img src="/img/Python/Flask/006tNbRwly1fybc5btgjhj30ia04odg2.jpg" alt="image-20181218235323817"></p> <p><img src="/img/Python/Flask/006tNbRwly1fybc5x7jgyj30hg04kdfw.jpg" alt="image-20181218235356303"></p> <h3 id="for语句"><a href="#for语句" class="header-anchor">#</a> for语句</h3> <p>for的语法和Python基本一样</p> <p><strong>遍历字典</strong></p> <p>实例：</p> <p>后台Python代码如下：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">username</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 给前台传递参数的方式</span>
    <span class="token comment"># 方式1： 直接在render_template中填写username参数</span>
    <span class="token comment"># return render_template('index.html',username=username)</span>

    <span class="token comment"># 方式2： 可以使用一个字典对象</span>
    content <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">u'张三'</span><span class="token punctuation">,</span>
        <span class="token string">'gender'</span><span class="token punctuation">:</span> <span class="token string">u'男'</span><span class="token punctuation">,</span>
        <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
        <span class="token string">'websites'</span><span class="token punctuation">:</span><span class="token punctuation">{</span> <span class="token comment"># 字典类型</span>
            <span class="token string">'baidu'</span><span class="token punctuation">:</span><span class="token string">'http://www.baidu.com'</span><span class="token punctuation">,</span>
            <span class="token string">'google'</span><span class="token punctuation">:</span> <span class="token string">'http://www.google.com'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">'users'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>  <span class="token comment"># 列表类型</span>
            <span class="token punctuation">{</span><span class="token string">'username'</span><span class="token punctuation">:</span><span class="token string">u'张三'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token string">'username'</span><span class="token punctuation">:</span><span class="token string">u'李四'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token string">'username'</span><span class="token punctuation">:</span><span class="token string">u'王五'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">:</span><span class="token number">38</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span><span class="token operator">**</span>content<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>前台html代码如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>


this is index 文件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
姓名：{{ username }} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">&gt;</span></span>
性别：{{ gender }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">&gt;</span></span>
年龄：{{ age }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>br</span><span class="token punctuation">&gt;</span></span>

{{ websites.baidu }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
{{ websites.google }}


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
for遍历字典
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- {% for k,v in websites.items() %}
    &lt;a href=&quot;{{ v }}&quot;&gt;{{ k }}&lt;/a&gt;
{% endfor %} --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
for遍历列表
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- {% for user in users %}
    &lt;li&gt;{{ user.username }}  ==&gt; age:{{ user.age }}&lt;/li&gt;
{% endfor %} --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>访问http://127.0.0.1:5000/index/  后的效果如下：</p> <p><img src="/img/Python/Flask/006tNbRwly1fybcujbjhej30i60lkmz3.jpg" alt="image-20181219001740441"></p> <h3 id="过滤器"><a href="#过滤器" class="header-anchor">#</a> 过滤器</h3> <p>过滤器的作用类似于if语句，可以处理一些变量，把原始的变量经过过滤器处理后，再展示处理后的变量值</p> <p><a href="http://docs.jinkan.org/docs/jinja2/templates.html#builtin-filters" target="_blank" rel="noopener noreferrer">官网过滤器列表<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>default过滤器</strong></p> <p>语法如下： 表示如果username不存在，就显示游客。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{{ username | default{'游客'} }}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>length过滤器</strong></p> <p>语法如下： 表示显示users变量的长度</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{{ users | length}}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="jinja2的继承"><a href="#jinja2的继承" class="header-anchor">#</a> Jinja2的继承</h3> <p>Jinja2的继承表示模板的继承，子页面继承父页面的结构，从而实现代码的复用。不用写重复的代码。</p> <p>语法如下：</p> <p>父模板中就正常写代码，然后留一些block块给子页面用，让子页面来填充该block内容</p> <p><strong>后台代码如下</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/login/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>base.html内容如下:父页面</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">body</span><span class="token punctuation">{</span>
            <span class="token property">color</span><span class="token punctuation">:</span>red
        <span class="token punctuation">}</span>
        <span class="token selector">.nav</span><span class="token punctuation">{</span>
           <span class="token property">hight</span><span class="token punctuation">:</span>100px<span class="token punctuation">;</span>
           <span class="token property">background</span><span class="token punctuation">:</span>#F98334<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nav<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

{% block main %}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>这是首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ url_for(<span class="token punctuation">'</span>login<span class="token punctuation">'</span>)}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
{% endblock %}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p><strong>login.html内容如下：子页面</strong></p> <p>登录页面是子页面，通过<code>extends</code>关键字继承父模板index.html，然后又写了个<code>block main</code>来填充父模板中留的块内容。实现的效果就是不同页面展示不同的h1</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>{% extends 'index.html' %}

{% block main %}

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>这是登录页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>

{% endblock %}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="/img/Python/Flask/006tNbRwly1fychnm2stej30gu0b6t9b.jpg" alt="image-20181219234930402"></p> <p><img src="/img/Python/Flask/006tNbRwly1fychnsdmfgj30iu08kwf4.jpg" alt="image-20181219234943708"></p> <h3 id="url链接"><a href="#url链接" class="header-anchor">#</a> URL链接</h3> <p>在Flask中，可以使用url_for的方式进行反转链接，以下url_for(login)的方式相当于http://localhost:5000/login/ 链接</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ url_for(<span class="token punctuation">'</span>login<span class="token punctuation">'</span>) }}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="加载静态文件"><a href="#加载静态文件" class="header-anchor">#</a> 加载静态文件</h3> <p>Flask默认会从static路径下加载静态文件，所以不用再加static目录前缀了，使用url_for的方式加载即可。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ url_for(<span class="token punctuation">'</span>static<span class="token punctuation">'</span>,filename=<span class="token punctuation">'</span>css/index.css<span class="token punctuation">'</span>) }}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/img/Python/Flask/006tNbRwly1fydmv1n09lj31ra0i243d.jpg" alt="image-20181220233505060"></p> <h2 id="flask-sqlalchemy"><a href="#flask-sqlalchemy" class="header-anchor">#</a> Flask-SQLAlchemy</h2> <p>在 Flask 中，为了简化配置和操作，我们使用的 ORM 框架是 <a href="http://flask-sqlalchemy.pocoo.org/" target="_blank" rel="noopener noreferrer">Flask-SQLAlchemy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，这个 Flask 扩展封装了 <a href="http://www.sqlalchemy.org/" target="_blank" rel="noopener noreferrer">SQLAlchemy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 框架。在 Flask-SQLAlchemy 中，数据库使用 URL 指定，下表列出了常见的数据库引擎和对应的 URL</p> <table><thead><tr><th>数据库引擎</th> <th>URL</th></tr></thead> <tbody><tr><td>MySQL</td> <td>mysql://username:password@hostname/database</td></tr> <tr><td>Postgres</td> <td>postgresql://username:password@hostname/database</td></tr> <tr><td>SQLite (Unix)</td> <td>sqlite:////absolute/path/to/database</td></tr> <tr><td>SQLite (Windows)</td> <td>sqlite:///c:/absolute/path/to/database</td></tr></tbody></table> <p><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014320114981139589ac5f02944601ae22834e9c521415000" target="_blank" rel="noopener noreferrer">廖雪峰讲SQLAlchemy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://segmentfault.com/a/1190000006949536" target="_blank" rel="noopener noreferrer">sqlalchemy学习笔记<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://segmentfault.com/a/1190000007396452" target="_blank" rel="noopener noreferrer">Flask 插件系列 - Flask-SQLAlchemy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h3> <p>通过pip安装</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pip install flask<span class="token operator">-</span>sqlalchemy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="连接到sqlite数据库"><a href="#连接到sqlite数据库" class="header-anchor">#</a> 连接到SQLite数据库</h3> <p>使用SQLAlchemy之前，需要先配置数据库连接，这里需要在一个固定的变量SQLALCHEMY_DATABASE_URI里配置数据库的URI配置。</p> <p>以下是一个简单的 和SQLite 数据库连接的示例：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># -*- coding: utf-8 -*-</span>

<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">from</span> flask_sqlalchemy <span class="token keyword">import</span> SQLAlchemy

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SQLALCHEMY_DATABASE_URI'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'sqlite:///db/users.db'</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SQLALCHEMY_TRACK_MODIFICATIONS'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token comment"># db 对象是 SQLAlchemy 类的实例，表示程序使用的数据库。</span>
db <span class="token operator">=</span> SQLAlchemy<span class="token punctuation">(</span>app<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;定义数据模型，一个模型就是一个class，对应数据库中一张表&quot;&quot;&quot;</span>
    __tablename__ <span class="token operator">=</span> <span class="token string">'users'</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> db<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>Integer<span class="token punctuation">,</span> primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    username <span class="token operator">=</span> db<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>String<span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span> unique<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> db<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>String<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">,</span> unique<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">,</span> email<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>username <span class="token operator">=</span> username
        self<span class="token punctuation">.</span>email <span class="token operator">=</span> email

    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'&lt;User %r&gt;'</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>username
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="连接到mysql数据库"><a href="#连接到mysql数据库" class="header-anchor">#</a> 连接到MySQL数据库</h3> <p>这次我们使用一个<code>config.py</code>文件来统计管理数据库相关的配置</p> <p><strong>config.py文件内容如下：</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># DEBUG模式</span>
DEBUG <span class="token operator">=</span> <span class="token boolean">False</span>

<span class="token comment"># SECRET_KEY</span>

<span class="token comment"># SQLALCHEMY</span>
DIALECT <span class="token operator">=</span> <span class="token string">'mysql'</span>
DRIVER <span class="token operator">=</span> <span class="token string">'pymysql'</span>
USERNAME <span class="token operator">=</span> <span class="token string">'root'</span>
PASSWORD <span class="token operator">=</span> <span class="token string">'fangzheng'</span>
HOST <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span>
PORT <span class="token operator">=</span> <span class="token number">3306</span>
DATABASE <span class="token operator">=</span> <span class="token string">'test'</span>

<span class="token comment"># SQLALCHEMY_DATABASE_URI是固定的变量名</span>
SQLALCHEMY_DATABASE_URI <span class="token operator">=</span> <span class="token string">&quot;{}+{}://{}:{}@{}:{}/{}?charset=utf8&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>DIALECT<span class="token punctuation">,</span>DRIVER<span class="token punctuation">,</span>USERNAME<span class="token punctuation">,</span>PASSWORD<span class="token punctuation">,</span>HOST<span class="token punctuation">,</span>PORT<span class="token punctuation">,</span>DATABASE<span class="token punctuation">)</span>

<span class="token comment"># 为了防止控制台的一个警告</span>
SQLALCHEMY_TRACK_MODIFICATIONS <span class="token operator">=</span> <span class="token boolean">False</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>然后在<code>app.py</code>中使用SQLAlchemy，需要先<code>from flask_sqlalchemy import SQLAlchemy</code>导入该包，然后我们的配置信息在config.py中，所以也需要导入进来</p> <p><strong>app.py文件内容如下：</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span>render_template
<span class="token keyword">from</span> flask_sqlalchemy <span class="token keyword">import</span> SQLAlchemy
<span class="token keyword">from</span> exts <span class="token keyword">import</span> app<span class="token punctuation">,</span>db
<span class="token keyword">import</span> config

<span class="token comment"># 加载配置文件</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>from_object<span class="token punctuation">(</span>config<span class="token punctuation">)</span>

<span class="token comment"># 验证数据库连接是否正确</span>
db <span class="token operator">=</span> SQLAlchemy<span class="token punctuation">(</span>app<span class="token punctuation">)</span>

<span class="token comment"># 模型：归档模型，对应数据库中的article表</span>
<span class="token keyword">class</span> <span class="token class-name">Article</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    __tablename__ <span class="token operator">=</span> <span class="token string">'article'</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>Integer<span class="token punctuation">,</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>autoincrement<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>String<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>nullable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    content <span class="token operator">=</span> Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>Text<span class="token punctuation">,</span>nullable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 模型：User对应数据库中的User表</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    __tablename__ <span class="token operator">=</span> <span class="token string">'user'</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>Integer<span class="token punctuation">,</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>autoincrement<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>comment<span class="token operator">=</span><span class="token string">'自增id'</span><span class="token punctuation">)</span>
    username <span class="token operator">=</span> Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>String<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>nullable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>comment<span class="token operator">=</span><span class="token string">'用户名'</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>Text<span class="token punctuation">,</span>nullable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>comment<span class="token operator">=</span><span class="token string">'密码'</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>nullable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>comment<span class="token operator">=</span><span class="token string">'邮箱'</span><span class="token punctuation">)</span>

<span class="token comment"># 使用create_all方法可以直接创建表，也可以验证数据库连接是否正确，如果不报错表示连接正确。</span>
db<span class="token punctuation">.</span>create_all<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>运行<code>app.py</code>文件，控制台不报错即是连接成功。</p> <h3 id="flask-sqlalchemy模型映射"><a href="#flask-sqlalchemy模型映射" class="header-anchor">#</a> Flask-SQLAlchemy模型映射</h3> <p>上面的<code>app.py</code>代码中使用了create_all()方法可以自动根据模型在你数据库中帮你帮你自动创建表</p> <h3 id="flask-sqlalchemy增删改查"><a href="#flask-sqlalchemy增删改查" class="header-anchor">#</a> Flask-SQLAlchemy增删改查</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 数据的增删改查</span>

    <span class="token comment"># 增加</span>
    article <span class="token operator">=</span> Article<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'title1'</span><span class="token punctuation">,</span>content<span class="token operator">=</span><span class="token string">'concent111'</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>add<span class="token punctuation">(</span>article<span class="token punctuation">)</span> <span class="token comment"># 将数据添加到会话中</span>
    db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 提交事务</span>

    <span class="token comment"># 查询：select * from article where title='title1';</span>
    article <span class="token operator">=</span> Article<span class="token punctuation">.</span>query<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>Article<span class="token punctuation">.</span>title <span class="token operator">==</span> <span class="token string">'title1'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> a <span class="token keyword">in</span> article<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>title<span class="token punctuation">,</span>a<span class="token punctuation">.</span>content<span class="token punctuation">)</span> <span class="token comment"># 打印：title1 concent111</span>

    <span class="token comment"># # 改：先把需要改的数据查出来，然后修改，最后再把修改后的数据进行事务提交</span>
    article <span class="token operator">=</span> Article<span class="token punctuation">.</span>query<span class="token punctuation">.</span>filter_by<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>article<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
    article<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'new title12334'</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>article<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
    <span class="token comment"># 提交事务</span>
    db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 删除</span>
    <span class="token comment"># 先查询出数据对象，然后删除，最后提交事务</span>
    article <span class="token operator">=</span> Article<span class="token punctuation">.</span>query<span class="token punctuation">.</span>filter_by<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>delete<span class="token punctuation">(</span>article<span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="flask-script"><a href="#flask-script" class="header-anchor">#</a> Flask-Script</h2> <p>Flask-Script的作用是可以通过命令行的方式操作flask，例如：通过命令启动flask应用，通过命令行migrate迁移表。</p> <p>安装：使用<code>pip install flask-script</code>命令安装即可，建议在虚拟环境中安装。</p> <p>安装完成后，建立一个<code>manager.py</code>文件，用来处理命令行的命令。</p> <p><strong>manager.py文件内容如下：</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#!/usr/bin/python</span>
<span class="token comment"># -*- coding: utf-8 -*-</span>

<span class="token keyword">from</span> flask_script <span class="token keyword">import</span> Manager
<span class="token keyword">from</span> db_scripts <span class="token keyword">import</span> DBManager
<span class="token keyword">from</span> exts <span class="token keyword">import</span> app

<span class="token comment"># 这里的app是flask的app</span>
manager <span class="token operator">=</span> Manager<span class="token punctuation">(</span>app<span class="token punctuation">)</span>

<span class="token comment"># 下面这个@manager需要和上面的manager变量名称保持一致！！！</span>
<span class="token decorator annotation punctuation">@manager<span class="token punctuation">.</span>command</span>
<span class="token keyword">def</span> <span class="token function">runserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 模拟服务器启动</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'服务器启动成功....'</span><span class="token punctuation">)</span>

<span class="token comment"># 添加数据库相关的命令db_scripts.py</span>
manager<span class="token punctuation">.</span>add_command<span class="token punctuation">(</span><span class="token string">'db'</span><span class="token punctuation">,</span>DBManager<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    manager<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>以上代码是模拟了一个服务器启动的命令<code>runserver</code></p> <p>然后再封装一个数据库操作相关的文件<code>db_scripts.py</code></p> <p><strong>db_scripts.py文件内容如下：</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#!/usr/bin/python</span>
<span class="token comment"># -*- coding: utf-8 -*-</span>

<span class="token keyword">from</span> flask_script <span class="token keyword">import</span> Manager

<span class="token comment">## 由于不用启动db_scripts.py这个文件，所以就不用传app对象了</span>
DBManager <span class="token operator">=</span> Manager<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@DBManager<span class="token punctuation">.</span>command</span>
<span class="token keyword">def</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'数据库初始化完成...'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@DBManager<span class="token punctuation">.</span>command</span>
<span class="token keyword">def</span> <span class="token function">migrate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'数据库表迁移成功...'</span><span class="token punctuation">)</span>

<span class="token comment">## 这里也不用像manager.py中那样manager.run()了</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>接下来运行<code>manager.py</code>文件即可</p> <p>启动虚拟环境，然后执行<code>python manager.py runserver</code>查看效果</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>fangzheng@localhost $ <span class="token builtin class-name">source</span> activate
<span class="token punctuation">(</span>flask-env<span class="token punctuation">)</span> fangzheng@localhost $ python manager.py runserver
<span class="token punctuation">(</span>flask-env<span class="token punctuation">)</span> fangzheng@localhost $ python manager.py db init
<span class="token punctuation">(</span>flask-env<span class="token punctuation">)</span> fangzheng@localhost $ python manager.py db migrate
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>效果如下：类似于django</p> <p><img src="/img/Python/Flask/006tNbRwly1fyp8gsczdpj31d00bm436.jpg" alt="image-20181231002343830"></p> <h2 id="flask-migrate"><a href="#flask-migrate" class="header-anchor">#</a> Flask-Migrate</h2> <p>在以前的代码中，我们的model类的代码拆分出来在models.py中了，但是如果表结构更改后，是不会自动更新到数据库中的，一种解决办法就是：先<code>drop table</code>，然后再使用flask的<code>db.create_all()</code>方法来重新建表。显然这样的方式不太好。这时候，可以使用Flask-Migrate来解决。Flask-Migrate插件是基于Alembic，Alembic是由大名鼎鼎的SQLAlchemy作者开发数据迁移工具。专门来解决数据库迁移的问题。</p> <p><a href="https://flask-migrate.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">flask-migrate官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="安装-2"><a href="#安装-2" class="header-anchor">#</a> 安装</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pip install Flask<span class="token operator">-</span>Migrate
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>添加mirgate相关的command到manager.py文件中</p> <p><strong>Manager.py</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> app <span class="token keyword">import</span> create_app<span class="token punctuation">,</span> db
<span class="token keyword">from</span> app<span class="token punctuation">.</span>models <span class="token keyword">import</span> Users <span class="token punctuation">,</span> Users_detail  <span class="token comment">#注册数据库模型【【注意：这里一定要注册！！】】</span>
<span class="token keyword">from</span> flask_script <span class="token keyword">import</span> Manager<span class="token punctuation">,</span> Shell
<span class="token keyword">from</span> flask_migrate <span class="token keyword">import</span> Migrate<span class="token punctuation">,</span> MigrateCommand   <span class="token comment">#载入migrate扩展</span>
 
app <span class="token operator">=</span> create_app<span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">)</span>
manager <span class="token operator">=</span> Manager<span class="token punctuation">(</span>app<span class="token punctuation">)</span>
migrate <span class="token operator">=</span> Migrate<span class="token punctuation">(</span>app<span class="token punctuation">,</span> db<span class="token punctuation">)</span>  <span class="token comment">#注册migrate到flask</span>
 
manager<span class="token punctuation">.</span>add_command<span class="token punctuation">(</span><span class="token string">'db'</span><span class="token punctuation">,</span> MigrateCommand<span class="token punctuation">)</span>   <span class="token comment">#在终端环境下添加一个db命令</span>
 
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    manager<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="初始化"><a href="#初始化" class="header-anchor">#</a> <strong>初始化</strong></h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>python manage.py db init
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里的 <strong>init</strong> 只需要执行一次，以后的修改都不用执行了。同时当执行完init命令后，会在你项目根目录下创建一个migrations文件夹，里面存放了所有迁移脚本。</p> <h3 id="迁移"><a href="#迁移" class="header-anchor">#</a> 迁移</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>python manager.py db migrate -m <span class="token string">&quot;initial migrateion&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>其中-m表示添加提交版本信息的注释内容</li></ul> <p>在Alembic，数据库迁移工作由迁移脚本完成。这个脚本有两个函数，分别叫做<code>upgrade()</code>和<code>downgrade()</code></p> <p><code>upgrade()</code>：函数实施数据库更改，是迁移的一部分</p> <p><code>downgrade()</code>：函数则删除它们。通过添加和删除数据库变化的能力，Alembic可以重新配置数据库从历史记录中的任何时间点。将迁移中的改动从数据库中删除，即具有回滚到某个迁移点的功能。</p> <p>该步骤还会在数据库中生成<code>alembic_version</code>表，该表作为flask-migrateion的迁移记录表。</p> <h3 id="应用迁移"><a href="#应用迁移" class="header-anchor">#</a> 应用迁移</h3> <p>使用upgrade命令将迁移中的改动应用到数据库中</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>python manage.py db upgrade
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>所以正确的使用顺序是：</strong></p> <ol><li>使用<code>init</code>命令<code>python manage.py db init</code>初始化数据库和表（只执行一次即可）</li> <li>使用<code>migrate</code>命令<code>python manager.py db migrate -m &quot;initial migrateion&quot;</code>命令来生成迁移的py文件</li> <li>使用<code>upgrade</code>命令<code>python manage.py db upgrade</code>来把迁移文件中的内容(修改的ddl内容)应用到数据库中</li></ol> <h2 id="flask的models循环引用的问题"><a href="#flask的models循环引用的问题" class="header-anchor">#</a> Flask的models循环引用的问题</h2> <p>之前我们写的代码里是直接在app.py中写的model模型类(Article)，但是如果项目越来越大，这个model类会越来越多，代码臃肿。所以我们需要拆分代码，类似于java中的代码分层service、dao、bean之类的分包。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">from</span> flask_sqlalchemy <span class="token keyword">import</span> SQLAlchemy

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SQLALCHEMY_DATABASE_URI'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'sqlite:///./Article.db'</span>
SQLALCHEMY_TRACK_MODIFICATIONS <span class="token operator">=</span> <span class="token boolean">False</span>
db <span class="token operator">=</span> SQLAlchemy<span class="token punctuation">(</span>app<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Article</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    __tablename__<span class="token operator">=</span><span class="token string">'article'</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> db<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>Integer<span class="token punctuation">,</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> db<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>String<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>nullable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    content <span class="token operator">=</span> db<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>Text<span class="token punctuation">,</span>nullable<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># class1</span>
<span class="token comment"># class2</span>
<span class="token comment"># .....</span>

<span class="token comment"># db.create_all()</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'index'</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>拆分出models.py文件</strong></p> <p>新建models.py文件，把模型类放到models.py中，但是会出现循环引用的问题。</p> <p>依赖关系如下：</p> <p>主app.py文件中依赖models.py，models.py中依赖主app.py里的db对象</p> <p><img src="/img/Python/Flask/006tNc79ly1fyx66z1e36j31kw0icwv9.jpg" alt="image-20190106210711819"></p> <p><strong>解决办法</strong></p> <p>解决办法就是把循环引用的对象提取出来，放到另外的对象中。</p> <p><img src="/img/Python/Flask/006tNc79ly1fyx6aesebwj30xs0nwdo5.jpg" alt=""></p> <p><strong>代码结构如下图：</strong></p> <p><img src="/img/Python/Flask/006tNc79ly1fyx6hks4mdj320o0n87pd.jpg" alt="image-20190106211943589"></p> <h2 id="flask-cookie"><a href="#flask-cookie" class="header-anchor">#</a> Flask-Cookie</h2> <p>cookie的概念就不说了，这里直接说在flask中如何使用cookie，由于cookie是保存在浏览器中的，只需要知道概念即可，真正的操作是在前端js中操作。</p> <h2 id="flask-session"><a href="#flask-session" class="header-anchor">#</a> Flask-Session</h2> <p>在操作flask-session之前，需要先设置SECRET_KEY，这个SECRET_KEY主要是为了加密用的，可以理解为md5算法中加入盐的道理。</p> <p>在<code>config.py</code>中添加SECRET_KEY</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>SECRET_KEY <span class="token operator">=</span> <span class="token string">&quot;ijsdng238afks&quot;</span> <span class="token comment"># 任意24个字符长度的字符串即可</span>
<span class="token comment"># 也可以使用os模块中的urandom方法生成一个24位的随机字符串</span>
<span class="token keyword">import</span> os
SECRET_KEY <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="flask中操作session"><a href="#flask中操作session" class="header-anchor">#</a> flask中操作session</h3> <p>操作session跟操作python中的字典类型一样</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span>render_template<span class="token punctuation">,</span>session
<span class="token keyword">from</span> exts <span class="token keyword">import</span> app<span class="token punctuation">,</span>db
<span class="token keyword">from</span> models <span class="token keyword">import</span> User<span class="token punctuation">,</span>Article

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 添加</span>
    session<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'zhangsan'</span>
    
    <span class="token comment"># 读取：</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>session<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 方式1:如果username不存在，会抛出异常。</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 方式2【推荐】:如果username不存在，会返回一个null而不抛出异常 </span>
    
    <span class="token comment"># 删除</span>
    session<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span> <span class="token comment"># 删除指定session</span>
    session<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 删除session中的所有数据</span>
    
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="get和post请求"><a href="#get和post请求" class="header-anchor">#</a> Get和Post请求</h2> <p>get和post请求的介绍就不说了，主要说如何使用，以及如何获取相应请求的参数。</p> <h3 id="get"><a href="#get" class="header-anchor">#</a> Get</h3> <p>通过flask的request对象的args来获取</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>request.args
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="post"><a href="#post" class="header-anchor">#</a> Post</h3> <p>通过flask的request对象的form来获取</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>request<span class="token punctuation">.</span>form
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>实例代码如下：</strong></p> <p><strong>app.py</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span>render_template<span class="token punctuation">,</span>session<span class="token punctuation">,</span>request
<span class="token keyword">from</span> exts <span class="token keyword">import</span> app<span class="token punctuation">,</span>db
<span class="token keyword">from</span> models <span class="token keyword">import</span> User<span class="token punctuation">,</span>Article

<span class="token comment"># db.create_all()</span>


<span class="token comment"># Get请求,默认情况是使用Get请求</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/search/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 获取get请求的参数</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># args是一个字典类型，所以可以直接使用get方法来获取参数</span>
    <span class="token keyword">return</span> <span class="token string">'search'</span>


<span class="token comment"># post请求</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/login/'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'GET'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'get请求'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'post请求'</span><span class="token punctuation">)</span>
        <span class="token comment"># 获取post请求的参数</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p><strong>login.html</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ url_for(<span class="token punctuation">'</span>login<span class="token punctuation">'</span>) }}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>用户名：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>密  码：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>提交<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="g-global-对象"><a href="#g-global-对象" class="header-anchor">#</a> g(global)对象</h2> <ol><li><p>g对象是专门用来保存用户的数据的。</p></li> <li><p>g对象在一次请求中的所有的代码的地方，都是可以使用的。</p></li></ol> <p>从flask中导入<code>from flask import Flask,g</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># Get请求,默认情况是使用Get请求</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/search/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 获取get请求的参数</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">)</span>
    username <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span> <span class="token comment"># args是一个字典类型，所以可以直接使用get方法来获取参数</span>
    g<span class="token punctuation">.</span>username <span class="token operator">=</span> username <span class="token comment"># 把username放到g对象里，这样在其他任何地方都能获取到该g对象里的username属性了</span>
    <span class="token keyword">return</span> <span class="token string">'search'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="钩子函数"><a href="#钩子函数" class="header-anchor">#</a> 钩子函数</h2> <p>钩子函数是指在执行函数和目标函数之间挂载的函数, 框架开发者给调用方提供一个<strong>point</strong> -挂载点, 至于挂载什么函数有我们调用方决定, 这样大大提高了灵活性。</p> <p>在程序正常运行的时候，程序按照A函数—-&gt;B函数的顺序依次运行；钩子函数可以插入到A函数到B函数运行中间从而，程序运行顺序变成了A—-&gt;钩子函数—-&gt;B函数。</p> <p>常用的钩子函数</p> <h3 id="before-first-request"><a href="#before-first-request" class="header-anchor">#</a> before_first_request</h3> <p><code>before_first_request</code> 处理第一次请求之前执行</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 服务器被第一次访问执行的钩子函数</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>before_first_request</span>
<span class="token keyword">def</span> <span class="token function">first_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;first time request&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="before-request"><a href="#before-request" class="header-anchor">#</a> before_request</h3> <p><code>before_request</code> 在每次请求之前执行. 通常使用这个钩子函数预处理一些变量, 视图函数可以更好调用</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 在服务器接收的请求还没分发到视图函数之前执行的钩子函数</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>before_request</span>
<span class="token keyword">def</span> <span class="token function">before_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># print(&quot;我勾住了每次请求&quot;)</span>
    user_id <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;user_id&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> user_id<span class="token punctuation">:</span>
        g<span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token string">&quot;DaYe&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="context-processt"><a href="#context-processt" class="header-anchor">#</a> context_processt</h3> <p><code>context_processor</code> 上下文处理器, 返回的字典可以在全部模板中使用</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>context_processor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 必须返回一个字典</span>
    <span class="token comment"># hasattr(obj, attr) 判断obj是否有attr属性, 注意此时的attr应该是字符串</span>
    <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">&quot;current_username&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;DaYe&quot;</span><span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># 注意: 必须返回一个字典</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="teardown-appcontext"><a href="#teardown-appcontext" class="header-anchor">#</a> teardown_appcontext</h3> <p><code>teardown_appcontext</code> 当APP上下文被移除之后执行的函数, 可以进行数据库的提交或者回滚</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>teardown_appcontext</span>
<span class="token keyword">def</span> <span class="token function">teardown</span><span class="token punctuation">(</span>exc<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> exc <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>rollback<span class="token punctuation">(</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="template-filter"><a href="#template-filter" class="header-anchor">#</a> template_filter</h3> <p><code>template_filter</code>, 增加模板过滤器</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>template_filter</span>
<span class="token keyword">def</span> <span class="token function">upper_filter</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> s<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="errorhander"><a href="#errorhander" class="header-anchor">#</a> errorhander</h3> <p><code>errorhander</code>, 在发生一些异常时, 比如404错误, 就会自动调用对应的钩子函数</p> <ol><li>发生请求错误时, 框架会自动调用相对钩子函数, 并向钩子函数传入<code>error</code>参数</li> <li>如果钩子函数没有定义<code>error</code>参数, 就会报服务器错误</li> <li>开发者可以通过<code>flask.abort</code>方法手动抛出异常, 比如发现输入的参数错误可以使用<code>abort(404)</code>来解决</li></ol> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhander</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">page_not_found</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&quot;error400.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">404</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhander</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">server_error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">&quot;error505.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=Python" title="标签">#Python</a><a href="/tags/?tag=flask" title="标签">#flask</a></div> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">2022/7/23 10:17:11</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/eea4c8/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Flask</div></a> <a href="/pages/e6e420/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">【转】Python的命令行神器 Click</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/eea4c8/" class="prev">Flask</a></span> <span class="next"><a href="/pages/e6e420/">【转】Python的命令行神器 Click</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/e4ae6f/"><div>
            分区分桶
            <!----></div></a> <span class="date">08-21</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/35c27e/"><div>
            数据模型（重要）
            <!----></div></a> <span class="date">08-21</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/a9c642/"><div>
            安装和编译
            <!----></div></a> <span class="date">08-21</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> <!----></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><!----><div></div></div></div>
    <script src="/assets/js/app.6c912f34.js" defer></script><script src="/assets/js/2.a5fab8cd.js" defer></script><script src="/assets/js/131.4ba5d4e1.js" defer></script>
  </body>
</html>

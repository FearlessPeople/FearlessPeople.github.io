(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{504:function(s,a,n){"use strict";n.r(a);var t=n(10),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"binlog介绍"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#binlog介绍"}},[s._v("#")]),s._v(" binlog介绍")]),s._v(" "),n("p",[s._v("binlog是Mysql sever数据库维护的一种"),n("code",[s._v("二进制")]),s._v("日志，与innodb引擎中的redo/undo log是完全不同的日志；其主要是用来记录对mysql数据更新或潜在发生更新的SQL语句（查询的日志不记录），并以"),n("strong",[s._v("事务")]),s._v("的形式保存在磁盘中。")]),s._v(" "),n("p",[s._v("MySQL Server 有四种类型的日志:")]),s._v(" "),n("ol",[n("li",[n("p",[n("code",[s._v("Error Log")])]),s._v(" "),n("p",[s._v("错误日志，记录 mysqld 的一些错误信息。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("General Query Log")])]),s._v(" "),n("p",[s._v("一般查询日志，记录 mysqld 正在做的事情，比如客户端的连接和断开、来自客户端每条 Sql Statement 记录信息；例如：查看客户端到底传了什么信息给服务端，这个日志就非常管用了，不过它非常影响性能")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("Binary Log")])]),s._v(" "),n("p",[s._v("包含了一些事件，这些事件描述了数据库的改动，如建表、数据改动等，也包括一些潜在改动，比如"),n("code",[s._v("DELETE FROM ran WHERE bing = luan;")])]),s._v(" "),n("p",[n("strong",[s._v("Binlog 就有了两个重要的用途——复制和恢复。比如主从表的复制，和备份恢复。")])])]),s._v(" "),n("li",[n("p",[n("code",[s._v("Slow Query Log")])]),s._v(" "),n("p",[s._v("慢查询日志，记录一些查询比较慢的 SQL 语句——这种日志非常常用，主要是给开发者调优用的。")])])]),s._v(" "),n("h2",{attrs:{id:"binlog使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#binlog使用"}},[s._v("#")]),s._v(" binlog使用")]),s._v(" "),n("h3",{attrs:{id:"启用binlog"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启用binlog"}},[s._v("#")]),s._v(" 启用binlog")]),s._v(" "),n("p",[s._v("要启用binlog，必须在mysql的"),n("code",[s._v("/etc/my.cnf")]),s._v("文件中进行配置。")]),s._v(" "),n("p",[n("strong",[s._v("编辑my.cnf文件")])]),s._v(" "),n("p",[s._v("默认情况 MySQL 的 binlog是关闭状态的，所以需要先启动binlog。")]),s._v(" "),n("p",[s._v("修改 "),n("code",[s._v("my.cnf")]),s._v("，然后在"),n("code",[s._v("mysqld")]),s._v("选项下添加如下值：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## binlog日志文件的前缀")]),s._v("\nlog-bin"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql-bin\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## binlog的index文件的名称")]),s._v("\nlog-bin-index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql-bin.index\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## binlog的工作模式")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_format")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ROW'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h4",{attrs:{id:"mysql-binlog的三种工作模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql-binlog的三种工作模式"}},[s._v("#")]),s._v(" MySQL binlog的三种工作模式")]),s._v(" "),n("ol",[n("li",[n("p",[n("code",[s._v("Row level")])]),s._v(" "),n("p",[s._v("日志中会记录每一行数据被修改的情况，然后在slave端对相同的数据进行修改。")]),s._v(" "),n("p",[n("strong",[s._v("优点")]),s._v("：能清楚的记录每一行数据修改的细节")]),s._v(" "),n("p",[n("strong",[s._v("缺点")]),s._v("：数据量太大")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("Statement level（默认）")])]),s._v(" "),n("p",[s._v("每一条被修改数据的sql都会记录到master的bin-log中，slave在复制的时候sql进程会解析成和原来master端执行过的相同的sql再次执行")]),s._v(" "),n("p",[n("strong",[s._v("优点")]),s._v("：解决了 Row level下的缺点，不需要记录每一行的数据变化，减少bin-log日志量，节约磁盘IO，提高新能")]),s._v(" "),n("p",[n("strong",[s._v("缺点")]),s._v("：容易出现主从复制不一致")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("Mixed（混合模式）")])]),s._v(" "),n("p",[s._v("结合了Row level和Statement level的优点")])])]),s._v(" "),n("h3",{attrs:{id:"重启mysql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重启mysql"}},[s._v("#")]),s._v(" 重启mysql")]),s._v(" "),n("p",[n("span",{staticStyle:{color:"red","font-size":"20px","font-weight":"bold"}},[s._v("注意：对mysql的/etc/my.cnf文件的修改，需要重启MySQL服务！")])]),s._v(" "),n("p",[n("strong",[s._v("centos下重启命令：")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# service mysqld restart")]),s._v("\nStopping mysqld:                                           "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("  OK  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nStarting mysqld:                                           "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("  OK  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[n("strong",[s._v("mac下重启命令：")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动MySQL服务")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" /usr/local/MySQL/support-files/mysql.server start\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止MySQL服务")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" /usr/local/mysql/support-files/mysql.server stop\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启MySQL服务")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" /usr/local/mysql/support-files/mysql.server restart\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("Mac下也可以通过偏好设置里来启动和停止MySQL")]),s._v(" "),n("p",[n("img",{attrs:{src:"/img/DataBase/MySQL/006tNbRwly1fvndcxf4qrj31140hg784.jpg",alt:"image-20180926234103957"}})]),s._v(" "),n("h3",{attrs:{id:"查看binlog开启状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看binlog开启状态"}},[s._v("#")]),s._v(" "),n("strong",[s._v("查看binlog开启状态")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("mysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SHOW VARIABLES LIKE "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%log_bin%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+---------------------------------+--------------------------------+\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Variable_name                   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Value                          "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+---------------------------------+--------------------------------+\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" log_bin                         "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ON                             "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" log_bin_basename                "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /var/lib/mysql/mysql-bin       "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" log_bin_index                   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /var/lib/mysql/mysql-bin.index "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" log_bin_trust_function_creators "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" OFF                            "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" log_bin_use_v1_row_events       "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" OFF                            "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" sql_log_bin                     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ON                             "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+---------------------------------+--------------------------------+\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),n("p",[s._v("log_bin等于on表示成功开启了binlog")])]),s._v(" "),n("h3",{attrs:{id:"查看master状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看master状态"}},[s._v("#")]),s._v(" "),n("strong",[s._v("查看master状态")])]),s._v(" "),n("p",[s._v("即最后（最新）一个binlog日志的编号名称，及其最后一个操作事件pos结束点(Position)值。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("mysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show master status"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+------------------+----------+--------------+------------------+-------------------------------------------------+\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" File             "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Position "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Binlog_Do_DB "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Binlog_Ignore_DB "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Executed_Gtid_Set                               "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+------------------+----------+--------------+------------------+-------------------------------------------------+\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql-bin.000020 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("56217764")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("              "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ad9a34e4-bd71-11e9-b5b2-00163e143f99:1-19076813 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+------------------+----------+--------------+------------------+-------------------------------------------------+\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" row "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.03")]),s._v(" sec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"查看binlog日志"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看binlog日志"}},[s._v("#")]),s._v(" "),n("strong",[s._v("查看binlog日志")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /var/lib/mysql/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("176152")]),s._v("\n-rw-rw----. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":56 auto.cnf\ndrwx------. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mysql mysql     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Jun "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" 03:40 hive_metadata\n-rw-rw----. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("79691776")]),s._v(" Sep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" 00:07 ibdata1\n-rw-rw----. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50331648")]),s._v(" Sep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" 00:07 ib_logfile0\n-rw-rw----. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50331648")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":56 ib_logfile1\ndrwx------. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mysql mysql     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":56 mysql\n-rw-rw----. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql      "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),s._v(" Sep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" 00:07 mysql-bin.000001\n-rw-rw----. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" Sep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" 00:07 mysql-bin.index\nsrwxrwxrwx. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" mysql mysql        "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Sep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" 00:07 mysql.sock\ndrwx------. "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" mysql mysql     "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Apr "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":56 performance_schema\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqlbinlog mysql-bin.000001")]),s._v("\nmysqlbinlog: unknown variable "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'default-character-set=utf8'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[n("span",{staticStyle:{color:"red","font-size":"20px","font-weight":"bold"}},[s._v("mysqlbinlog: unknown variable 'default-character-set=utf8'")])]),s._v(" "),n("p",[s._v("直接cd进到刚才binlog存储的目录，发现使用mysqlbinlog工具查看的时候，出现了个错误。"),n("code",[s._v("mysqlbinlog: unknown variable 'default-character-set=utf8'")])]),s._v(" "),n("p",[s._v("原因是：mysqlbinlog这个工具无法识别binlog中的配置中的"),n("code",[s._v("default-character-set=utf8")]),s._v("这个指令")]),s._v(" "),n("p",[n("strong",[s._v("解决办法：")])]),s._v(" "),n("ol",[n("li",[n("p",[s._v("把my.cnf文件中client下的"),n("code",[s._v("default-character-set=utf8")]),s._v("修改成"),n("code",[s._v("character-set-server = utf8")])]),s._v(" "),n("p",[s._v("然后重启MySQL服务永久生效")])]),s._v(" "),n("li",[n("p",[s._v("无需重启环境，使用"),n("code",[s._v("--no-defaults")])]),s._v(" "),n("p",[s._v("使用"),n("code",[s._v("mysqlbinlog --no-defaults mysql-bin.000001")]),s._v("的"),n("code",[s._v("--no-defaults")]),s._v("选项来查看binlog日志")])])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqlbinlog --no-defaults mysql-bin.000001")]),s._v("\n/*"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50530")]),s._v(" SET @@"),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("SESSION")]),s._v(".PSEUDO_SLAVE_MODE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("*/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n/*"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("40019")]),s._v(" SET @@session.max_insert_delayed_threads"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("*/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n/*"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50003")]),s._v(" SET @OLD_COMPLETION_TYPE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("@@COMPLETION_TYPE,COMPLETION_TYPE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("*/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nDELIMITER /*"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("*/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# at 4")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#180927  0:07:30 server id 1  end_log_pos 120 CRC32 0xcbc08ea5 \tStart: binlog v 4, server v 5.6.40-log created 180927  0:07:30 at startup")]),s._v("\nROLLBACK/*"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("*/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nBINLOG "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nwq6rWw8BAAAAdAAAAHgAAAAAAAQANS42LjQwLWxvZwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAADCrqtbEzgNAAgAEgAEBAQEEgAAXAAEGggAAAAICAgCAAAACgoKGRkAAaWO\nwMs=\n'")]),s._v("/*"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("*/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# at 120")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#180927  0:09:43 server id 1  end_log_pos 167 CRC32 0xb760697c \tRotate to mysql-bin.000002  pos: 4")]),s._v("\nDELIMITER "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# End of log file")]),s._v("\nROLLBACK /* added by mysqlbinlog */"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n/*"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50003")]),s._v(" SET "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("COMPLETION_TYPE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("@OLD_COMPLETION_TYPE*/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n/*"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50530")]),s._v(" SET @@"),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("SESSION")]),s._v(".PSEUDO_SLAVE_MODE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("*/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h2",{attrs:{id:"binlog的解析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#binlog的解析"}},[s._v("#")]),s._v(" binlog的解析")]),s._v(" "),n("p",[s._v("对应MySQL的"),n("code",[s._v("binlog")]),s._v("的解析，可先通过如下文章了解"),n("code",[s._v("binlog")]),s._v("的组成。")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/mysql-dba/p/9901655.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySQL Binlog解析（1）"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/mysql-dba/p/9901659.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySQL Binlog解析（2）"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("实际工作中，可使用"),n("code",[s._v("canal")]),s._v("、"),n("code",[s._v("maxwell")]),s._v("、"),n("code",[s._v("mysql_streamer")]),s._v("等工具来解析"),n("code",[s._v("binlog")]),s._v("日志")]),s._v(" "),n("h3",{attrs:{id:"canal、maxwell、mysql-streamer对比"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#canal、maxwell、mysql-streamer对比"}},[s._v("#")]),s._v(" canal、maxwell、mysql_streamer对比")]),s._v(" "),n("p",[n("img",{attrs:{src:"/img/DataBase/MySQL/parse-binlog.png",alt:"canal、maxwell、mysql_streamer对比"}})]),s._v(" "),n("h3",{attrs:{id:"maxwell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#maxwell"}},[s._v("#")]),s._v(" Maxwell")]),s._v(" "),n("p",[n("strong",[s._v("maxwell 简介")])]),s._v(" "),n("p",[s._v("Maxwell是一个能实时读取MySQL二进制日志binlog，并生成 JSON 格式的消息，作为生产者发送给 Kafka")]),s._v(" "),n("p",[s._v("Kinesis、RabbitMQ、Redis、Google Cloud Pub/Sub、文件或其它平台的应用程序。它的常见应用场景有ETL、维护")]),s._v(" "),n("p",[s._v("缓存、收集表级别的dml指标、增量到搜索引擎、数据分区迁移、切库binlog回滚方案等。"),n("a",{attrs:{href:"http://maxwells-daemon.io",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),n("OutboundLink")],1),s._v("、"),n("a",{attrs:{href:"https://github.com/zendesk/maxwell",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("strong",[s._v("Maxwell主要提供了下列功能：")])]),s._v(" "),n("ul",[n("li",[s._v("支持 "),n("code",[s._v("SELECT * FROM table")]),s._v(" 的方式进行全量数据初始化")]),s._v(" "),n("li",[s._v("支持在主库发生failover后，自动恢复binlog位置(GTID)")]),s._v(" "),n("li",[s._v("可以对数据进行分区，解决数据倾斜问题，发送到kafka的数据支持database、table、column等级别的数据分区")]),s._v(" "),n("li",[s._v("工作方式是伪装为Slave，接收binlog events，然后根据schemas信息拼装，可以接受ddl、xid、row等各种event")])]),s._v(" "),n("h3",{attrs:{id:"canal"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#canal"}},[s._v("#")]),s._v(" canal")]),s._v(" "),n("p",[s._v("canal 是阿里巴巴开源的由Java开发的一个MySQL的增量订阅&消费组件。分为服务端和客户端，拥有众多的衍生应用，性能稳定，功能强大；")]),s._v(" "),n("p",[s._v("官网："),n("a",{attrs:{href:"https://github.com/alibaba/canal",target:"_blank",rel:"noopener noreferrer"}},[s._v("canal"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("canal 需要自己编写客户端来消费canal解析到的数据。")]),s._v(" "),n("p",[n("code",[s._v("maxwell")]),s._v("相对于"),n("code",[s._v("canal")]),s._v("的优势是使用简单，它直接将数据变更输出为json字符串，不需要再编写客户端。而canal可以自定义客户端，可以将获取到的增量数据直接发送到MQ（kafka）中。")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://camo.githubusercontent.com/a9d41336a07581745beaa933f28a8f1860cb4eda/68747470733a2f2f696d672d626c6f672e6373646e696d672e636e2f32303139313130343130313733353934372e706e67",alt:"avatar"}})]),s._v(" "),n("h2",{attrs:{id:"附录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#附录"}},[s._v("#")]),s._v(" 附录")]),s._v(" "),n("h3",{attrs:{id:"binlog常用命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#binlog常用命令"}},[s._v("#")]),s._v(" binlog常用命令")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看binlog日志状态:即最后(最新)一个binlog日志的编号名称，及其最后一个操作事件pos结束点(Position)值")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show master status"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看所有binlog日志列表")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show master logs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 刷新binlog日志文件:刷新之后会新建一个新的Binlog日志")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" flush logs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 清空日志文件")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" reset master"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看binlog日志文件")]),s._v("\n$ mysqlbinlog --no-defaults mysql-bin.000002\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h3",{attrs:{id:"my-cnf文件位置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#my-cnf文件位置"}},[s._v("#")]),s._v(" my.cnf文件位置")]),s._v(" "),n("p",[s._v("默认情况下，MySQL将会按照给定的顺序从以下位置查找my.cnf文件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ mysql --help or mysql --help "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" my.cnf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("/etc/my.cnf\n/etc/mysql/my.cnf \n/usr/local/mysql/etc/my.cnf \n/usr/local/mysql/my.cnf \n~/.my.cnf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("strong",[s._v("创建my.cnf文件")])]),s._v(" "),n("p",[s._v("在5.7.18版本之前，MySQL默认在"),n("code",[s._v("/usr/local/mysql/support-files")]),s._v("这个文件夹中提供了一个"),n("code",[s._v("/usr/local/mysql/support-files/my-default.cnf")]),s._v("文件，将该文件copy至MySQL扫描的那几个目录即可。")]),s._v(" "),n("p",[s._v("但是：在5.7.18版本的MySQL之后，它不提供"),n("code",[s._v("support-files")]),s._v("目录中的默认配置文件。因此，您可以在MySQL将要读取的位置"),n("strong",[s._v("手动")]),s._v("创建"),n("code",[s._v("my.cnf")]),s._v("文件，例如"),n("code",[s._v("/etc/mysql/my.cnf")]),s._v("，并在文件中添加要添加的配置。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/my.cnf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"mysql5-7的my-cnf文件配置示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql5-7的my-cnf文件配置示例"}},[s._v("#")]),s._v(" MySQL5.7的my.cnf文件配置示例")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nport "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\ndefault-character-set"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8mb4\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("socket")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql/mysql.sock\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nport "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\ndefault-character-set"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8mb4\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("socket")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql/mysql.sock\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# summary")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\nbind-address "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\nport "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("basedir")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("datadir")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("socket")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql/mysql.sock\ntmpdir "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /tmp\npid-file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/mysqld.pid\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#skip-grant-tables")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#skip-networking")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("explicit_defaults_for_timestamp")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("lower_case_table_names")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\ntable_open_cache "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# time out")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\nconnect_timeout "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\nwait_timeout "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("86400")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# connection")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\nmax_connections "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v("\nmax_user_connections "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1900")]),s._v("\nmax_connect_errors "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100000")]),s._v("\nmax_allowed_packet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1G\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# character set")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\ncharacter-set-server "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8mb4\ncollation-server "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8mb4_bin\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log bin")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\nserver-id "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog_bin "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysql-bin\nbinlog_format "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MIXED\nsync_binlog "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nexpire_logs_days "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\nbinlog_cache_size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 128m\nmax_binlog_cache_size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("512m\nmax_binlog_size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("256M\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_ignore_db")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_ignore_db")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("information_schema\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_ignore_db")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("performation_schema\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_ignore_db")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sys\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log relay")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\nrelay_log "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysql-relay-bin\nrelay_log_purge "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\nrelay_log_recovery "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\nmax_relay_log_size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1G\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log error")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("log_error")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/mysqld_error.log\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log slow")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\nslow_query_log "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\nslow_query_log_file "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /var/log/mysqld_slow.log\nlong_query_time "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nlog_queries_not_using_indexes "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log general")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\ngeneral_log "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\ngeneral_log_file "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /var/log/mysqld_gener.log\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# thread pool")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#thread_handling=pool-of-threads")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#thread_handling=one-thread-per-connection")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#thread_pool_oversubscribe=8 ")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# innodb")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_file_per_table")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_log_file_size")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1024M\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_log_buffer_size")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("64M\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# password policy")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# after init ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#validate_password_length=4         ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#validate_password_mixed_case_count=0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#validate_password_number_count=0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#validate_password_policy=0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#validate_password_special_char_count=0")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);
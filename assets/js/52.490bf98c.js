(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{494:function(s,a,t){"use strict";t.r(a);var e=t(10),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"参考文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[s._v("#")]),s._v(" 参考文档")]),s._v(" "),t("p",[t("a",{attrs:{href:"http://tez.apache.org/install.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/u012940672/article/details/48135951",target:"_blank",rel:"noopener noreferrer"}},[s._v("apache tez on hadoop-2.7.1"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"获取软件地址"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取软件地址"}},[s._v("#")]),s._v(" 获取软件地址")]),s._v(" "),t("p",[t("code",[s._v("wget http://mirrors.shu.edu.cn/apache/tez/0.8.4/apache-tez-0.8.4-bin.tar.gz")])]),s._v(" "),t("p",[s._v("通过浏览器打开以上链接后")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/BigData/Tez/006tKfTcly1ft1axl7ijdj30wu076ab9.jpg",alt:""}})]),s._v(" "),t("p",[s._v("其中bin是编译后的tar包，src需要自行编译。这里直接下载编译后的即可。")]),s._v(" "),t("h2",{attrs:{id:"解压tar-gz包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解压tar-gz包"}},[s._v("#")]),s._v(" 解压tar.gz包")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf apache-tez-0.8.4-bin.tar.gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("然后将解压后的"),t("code",[s._v("apache-tez-0.8.4-bin")]),s._v("目录拷贝到"),t("code",[s._v("/usr/local/hadoop/")]),s._v("目录下，这个目录你自己定")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r apache-tez-0.8.4-bin /usr/local/hadoop/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"上传tez-tar-gz包到hdfs上"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#上传tez-tar-gz包到hdfs上"}},[s._v("#")]),s._v(" 上传tez.tar.gz包到hdfs上")]),s._v(" "),t("p",[s._v("将"),t("code",[s._v("apache-tez-0.8.4-bin/share/tez.tar.gz")]),s._v("文件上传到hdfs的某个目录上")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("hadoop fs -mkdir /user/tez\nhadoop fs -put tez.tar.gz /user/tez\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("上传成功后的目录如下：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/BigData/Tez/006tKfTcly1ft1acatagxj31kw07agn3.jpg",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"配置tez-site-xml"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置tez-site-xml"}},[s._v("#")]),s._v(" 配置tez-site.xml")]),s._v(" "),t("p",[s._v("拷贝"),t("code",[s._v("${TEZ_HOME}/conf/tez-default-template.xml")]),s._v("到hadoop的"),t("code",[s._v("etc/hadoop目")]),s._v("录下,并重命名为"),t("code",[s._v("tez-site.xml")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp tez-default-template.xml /usr/local/hadoop/hadoop-2.7.4/etc/hadoop/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /usr/local/hadoop/hadoop-2.7.4/etc/hadoop/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mv tez-default-template.xml tez-site.xml")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("编辑"),t("code",[s._v("${HADOOP_HOME}/etc/hadoop/tez-site.xml")]),s._v("文件,修改"),t("code",[s._v("tez.lib.uris")]),s._v("（700行）为你上传到hdfs的路径")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("tez.lib.uris"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("string"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${fs.default.name}")]),s._v("/user/tez/tez.tar.gz"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"配置环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置环境变量"}},[s._v("#")]),s._v(" 配置环境变量")]),s._v(" "),t("p",[s._v("编辑"),t("code",[s._v("${HADOOP_HOME}/etc/hadoop/hadoop-env.sh")]),s._v("文件，增加如下配置。注意路径的问题")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TEZ_CONF_DIR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/hadoop/hadoop-2.7.4/etc/hadoop/tez-site.xml\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TEZ_JARS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/hadoop/tez-0.8.4/\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HADOOP_CLASSPATH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HADOOP_CLASSPATH}")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TEZ_CONF_DIR}")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TEZ_JARS}")]),s._v("/*:"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${TEZ_JARS}")]),s._v("/lib/*\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"拷贝文件到其他从节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#拷贝文件到其他从节点"}},[s._v("#")]),s._v(" 拷贝文件到其他从节点")]),s._v(" "),t("p",[s._v("我这里mini1是主节点，mini2和mini3是从节点")]),s._v(" "),t("p",[s._v("需要拷贝的如下：")]),s._v(" "),t("ol",[t("li",[t("code",[s._v("/usr/local/hadoop/tez-0.8.4")]),s._v("目录下所有文件")]),s._v(" "),t("li",[t("code",[s._v("${HADOOP_HOME}/etc/hadoop/hadoop-env.sh")])]),s._v(" "),t("li",[t("code",[s._v("${HADOOP_HOME}/etc/hadoop/tez-site.xml")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#拷贝tez-0.8.4目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp -r /usr/local/hadoop/tez-0.8.4/ root@mini2:/usr/local/hadoop/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp -r /usr/local/hadoop/tez-0.8.4/ root@mini3:/usr/local/hadoop/")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#拷贝hadoop-env.sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp hadoop-env.sh root@mini2:/usr/local/hadoop/hadoop-2.7.4/etc/hadoop/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp hadoop-env.sh root@mini3:/usr/local/hadoop/hadoop-2.7.4/etc/hadoop/")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#拷贝tez-site.xml")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp tez-site.xml root@mini2:/usr/local/hadoop/hadoop-2.7.4/etc/hadoop/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp tez-site.xml root@mini3:/usr/local/hadoop/hadoop-2.7.4/etc/hadoop/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h2",{attrs:{id:"重启hadoop集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启hadoop集群"}},[s._v("#")]),s._v(" 重启hadoop集群")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# stop-all.sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# start-all.sh")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"测试demo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试demo"}},[s._v("#")]),s._v(" 测试demo")]),s._v(" "),t("p",[s._v("运行tez的"),t("code",[s._v("examples-0.8.4.jar")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /usr/local/hadoop/tez-0.8.4")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@mini1 conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hadoop jar tez-examples-0.8.4.jar orderedwordcount /input /output")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"hive中测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hive中测试"}},[s._v("#")]),s._v(" hive中测试")]),s._v(" "),t("p",[s._v("在hive中随便找张表测试")]),s._v(" "),t("h3",{attrs:{id:"不使用tez的情况"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#不使用tez的情况"}},[s._v("#")]),s._v(" 不使用tez的情况")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("hive"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show tables"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nOK\ndim_is_dirty_reason\nt_user\nTime taken: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.942")]),s._v(" seconds, Fetched: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" row"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nhive"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" desc t_user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nOK\ncity_code           \tstring              \t城市编码\narea_code           \tstring              \t区代码\nTime taken: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.182")]),s._v(" seconds, Fetched: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" row"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nhive"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" max"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("city_code"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" from t_user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nQuery ID "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" root_20180706222011_82d404af-01e7-4fba-9617-3ac0826b41f5\nTotal "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("jobs")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nLaunching Job "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" out of "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nNumber of reduce tasks determined at compile time: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nIn order to change the average load "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" a reducer "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("in bytes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" hive.exec.reducers.bytes.per.reducer"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("number"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nIn order to limit the maximum number of reducers:\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" hive.exec.reducers.max"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("number"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nIn order to "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" a constant number of reducers:\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" mapreduce.job.reduces"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("number"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nStarting Job "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" job_1530884943794_0002, Tracking URL "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" http://mini1:18088/proxy/application_1530884943794_0002/\nKill Command "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/hadoop/hadoop-2.7.4/bin/hadoop job  -kill job_1530884943794_0002\nHadoop job information "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" Stage-1: number of mappers: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" number of reducers: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-07-06 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":20:20,058 Stage-1 map "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%,  reduce "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-07-06 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":20:24,318 Stage-1 map "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("%,  reduce "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%, Cumulative CPU "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.71")]),s._v(" sec\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-07-06 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":20:25,361 Stage-1 map "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%,  reduce "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("%, Cumulative CPU "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.45")]),s._v(" sec\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2018")]),s._v("-07-06 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":20:30,575 Stage-1 map "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%,  reduce "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%, Cumulative CPU "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.28")]),s._v(" sec\nMapReduce Total cumulative CPU time: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" seconds "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("280")]),s._v(" msec\nEnded Job "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" job_1530884943794_0002\nMapReduce Jobs Launched:\nStage-Stage-1: Map: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("  Reduce: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("   Cumulative CPU: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.28")]),s._v(" sec   HDFS Read: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11402")]),s._v(" HDFS Write: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" SUCCESS\nTotal MapReduce CPU Time Spent: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" seconds "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("280")]),s._v(" msec\nOK\na\nTime taken: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.546")]),s._v(" seconds, Fetched: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" row"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nhive"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br")])]),t("h3",{attrs:{id:"使用tez执行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用tez执行"}},[s._v("#")]),s._v(" 使用tez执行")]),s._v(" "),t("p",[s._v("首先使用"),t("code",[s._v("set hive.execution.engine=tez;")]),s._v("命令，设置该次mapreduce的任务执行使用tez执行引擎")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("hive"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("set hive.execution.engine"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tez"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nhive"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" max"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("city_code"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" from t_user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nQuery ID "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" root_20180706222140_2ce99175-b55e-4e91-89f0-7d0bbc2a3477\nTotal "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("jobs")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nLaunching Job "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" out of "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n\nStatus: Running "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Executing on YARN cluster with App "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" application_1530884943794_0003"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n--------------------------------------------------------------------------------\n        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED\n--------------------------------------------------------------------------------\nMap "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("   SUCCEEDED      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nReducer "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("   SUCCEEDED      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n--------------------------------------------------------------------------------\nVERTICES: 02/02  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%  ELAPSED TIME: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13.27")]),s._v(" s\n--------------------------------------------------------------------------------\nOK\na\nTime taken: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21.072")]),s._v(" seconds, Fetched: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" row"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nhive"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("p",[s._v("效果如下：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/BigData/Tez/006tKfTcly1ft1atl6kd3j317i0n8td7.jpg",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),t("p",[s._v("以上只是设置临时使用tez执行，如果需要使所有mapreduce任务都使用tez执行，需要将"),t("code",[s._v("mapre-site.xml")]),s._v("中的"),t("code",[s._v("mapreduce.framework.name")]),s._v("的格式从yarn改为yarn-tez")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("property")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("mapreduce.framework.name"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("yarn-tez"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("property")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ol",[t("li",[s._v("环境变量需要配置在"),t("code",[s._v("hadoop-env.sh")]),s._v("文件中")]),s._v(" "),t("li",[t("code",[s._v("tez-site.xml")]),s._v("中配置"),t("code",[s._v("tez.lib.uris")]),s._v("为你上传到hdfs的"),t("code",[s._v("tez.tar.gz")]),s._v("的路径")]),s._v(" "),t("li",[s._v("将配置信息拷贝到其他从节点")]),s._v(" "),t("li",[s._v("重启hadoop集群")]),s._v(" "),t("li",[s._v("hive命令行中使用"),t("code",[s._v("set hive.execution.engine=tez;")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);